<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Polyfill Example</title>

</head>
<body>
    <script src="polyfill-rollup.js"></script>
    <script>
        window.addEventListener("load", loaded)

        function loaded() {

            console.log(window.navigation)

            const urlSpan = document.getElementById("url");

            window.navigation.addEventListener(
                "navigate",
                event => {
                    console.log("Navigate event", event)

                    const url = new URL(event.destination.url);
                    console.log(event.destination.url)
                    urlSpan.innerText = url.pathname;

                    if (url.pathname === "/some/other") {
                        console.log("Preventing default");
                        event.preventDefault();
                        try {
                            console.log("Navigated");
                            window.navigation.navigate("/", {
                                state: "returned"
                            });
                        } catch (error) {
                            console.error(error);
                        }
                    } else {
                        // Intercept by default
                        event.intercept()
                    }

                }
            );

            if (window.navigation.currentEntry) {
                urlSpan.innerText = new URL(window.navigation.currentEntry.url).pathname;
            }

            console.log(window.navigation.currentEntry.url)


        }
    </script>

    <p>Current Url <span id="url"></span></p>

    <a href="/">Home Link</a>
    <a href="/some/page">Some Page Link</a>
    <a href="/some/other">Some Other Page Link</a>
</body>
</html>